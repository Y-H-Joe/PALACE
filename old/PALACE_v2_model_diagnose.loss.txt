########################### pred ###########################
tensor([[[-15.0676, -15.1707, -15.7085,  ..., -14.8672, -14.6374, -15.3861],
         [-14.0587, -14.0528, -14.5548,  ..., -13.7825, -13.5759, -14.3189],
         [-13.3979, -13.5417, -14.1523,  ..., -13.2647, -12.9828, -13.8783],
         ...,
         [ -7.6784,  -7.9059,  -8.1835,  ...,  -7.9130,  -7.4075,  -8.2419],
         [ -7.9351,  -8.1942,  -8.5707,  ...,  -8.1872,  -7.7390,  -8.5196],
         [ -7.4447,  -7.6237,  -7.9116,  ...,  -7.6658,  -7.0995,  -8.0320]],

        [[-14.6502, -15.0453, -15.5030,  ..., -14.6762, -14.6508, -15.0755],
         [-14.8978, -15.3579, -15.3157,  ..., -15.0651, -14.5727, -15.3115],
         [-14.8024, -15.0698, -15.3792,  ..., -14.8684, -14.6818, -15.0927],
         ...,
         [-10.2893, -10.3226, -10.5846,  ..., -10.2070,  -9.9281, -10.4677],
         [-10.1197, -10.1838, -10.4789,  ...,  -9.9987,  -9.7304, -10.3405],
         [-10.2759, -10.4275, -10.6910,  ..., -10.1831,  -9.9470, -10.5510]],

        [[-14.7442, -15.0734, -15.2941,  ..., -14.9134, -14.7914, -15.2905],
         [-12.0661, -12.5165, -12.4656,  ..., -12.5893, -12.0009, -12.5112],
         [-13.1986, -13.9765, -14.0652,  ..., -13.8608, -13.2732, -13.5415],
         ...,
         [ -9.8988, -10.1419, -10.0453,  ..., -10.3338,  -9.8417, -10.3688],
         [ -9.1928,  -9.5877,  -9.6180,  ...,  -9.8391,  -9.0168,  -9.8527],
         [ -9.0440,  -9.4845,  -9.3631,  ...,  -9.6140,  -8.8831,  -9.7076]],

        [[-13.1382, -13.3666, -13.2279,  ..., -13.4089, -12.4634, -13.9523],
         [-12.1372, -11.7786, -12.2226,  ..., -12.0042, -11.7233, -12.3095],
         [-13.4040, -13.7368, -14.4321,  ..., -13.7568, -13.2220, -13.7513],
         ...,
         [ -9.4900,  -9.6078,  -9.6033,  ...,  -9.5934,  -8.9832,  -9.5945],
         [ -9.3617,  -9.5543,  -9.4765,  ...,  -9.4527,  -8.9400,  -9.4966],
         [ -9.6168,  -9.6858,  -9.6493,  ...,  -9.7162,  -9.0871,  -9.6839]]],
       device='cuda:0', grad_fn=<_DDPSinkBackward>)
pred shape:torch.Size([4, 300, 166])
########################### label ###########################
tensor([[ 4,  4,  5,  ...,  1,  1,  1],
        [ 4,  5,  4,  ...,  1,  1,  1],
        [ 7,  8, 10,  ...,  1,  1,  1],
        [16,  8, 10,  ...,  1,  1,  1]], device='cuda:0')
label shape:torch.Size([4, 300])
########################### valid_len ###########################
tensor([166, 156,  80,  65], device='cuda:0')
valid_len shape:torch.Size([4])
########################### weights ###########################
tensor([[1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0]], device='cuda:0')
########################### unweighted_loss ###########################
tensor([[1.0761e-03, 5.5770e-02, 3.5480e-01,  ..., 7.9059e+00, 8.1942e+00,
         7.6237e+00],
        [3.6453e-03, 3.2419e-03, 5.9649e-03,  ..., 1.0323e+01, 1.0184e+01,
         1.0427e+01],
        [2.6758e-03, 1.1780e-02, 4.0775e-02,  ..., 1.0142e+01, 9.5877e+00,
         9.4845e+00],
        [1.8518e-02, 7.0992e-03, 9.2821e-04,  ..., 9.6078e+00, 9.5543e+00,
         9.6858e+00]], device='cuda:0', grad_fn=<ViewBackward0>)
########################### weighted_loss ###########################
tensor([52.8774, 70.7797, 19.7136,  5.7990], device='cuda:0',
       grad_fn=<SumBackward1>)