########################### pred ###########################
tensor([[[-16.2809, -14.4809, -13.4085,  ..., -16.5058, -14.0060, -15.3624],
         [-14.0634, -12.1590, -11.8836,  ..., -13.7793, -12.5102, -12.4503],
         [-14.6411, -13.6681, -13.3215,  ..., -15.1524, -13.7720, -13.9575],
         ...,
         [-15.4082, -14.1031, -14.5414,  ..., -16.4631, -14.5389, -15.2202],
         [-15.6961, -14.4475, -14.7832,  ..., -16.7235, -14.3454, -14.9430],
         [-15.2678, -13.9950, -14.1216,  ..., -15.7996, -13.8499, -14.4216]],

        [[-12.9184, -12.7591, -11.7865,  ..., -13.4537, -12.4641, -12.8431],
         [-13.8006, -14.6787, -13.5410,  ..., -15.1942, -14.2130, -13.6857],
         [-13.7908, -13.8891, -12.3387,  ..., -13.9709, -12.8725, -13.2214],
         ...,
         [-10.4554, -10.4733, -10.8065,  ..., -10.6850,  -7.7794,  -9.1777],
         [-10.1016, -10.0656, -10.2084,  ..., -10.7545,  -8.1622,  -8.7398],
         [-11.4736, -11.3326, -12.0127,  ..., -11.6760,  -8.8070,  -9.5999]],

        [[-13.0386, -13.5665, -13.3459,  ..., -14.1845, -13.4935, -13.7971],
         [-12.3619, -11.8661, -12.2363,  ..., -13.8302, -13.0618, -12.2139],
         [-13.6837, -12.2112, -13.2071,  ..., -14.8447, -14.2989, -14.4899],
         ...,
         [-13.5651, -12.9126, -12.3891,  ..., -15.1695, -12.0861, -12.1421],
         [-12.7561, -12.5262, -11.8945,  ..., -14.3227, -11.2180, -11.3580],
         [-13.1661, -12.8413, -12.3061,  ..., -15.0810, -11.3862, -11.7959]],

        [[-12.0907, -13.1761, -12.2699,  ..., -11.4202, -12.3970, -12.2910],
         [-13.2197, -12.5946, -12.4262,  ..., -14.2570, -13.8526, -13.9166],
         [-12.1509, -12.7275, -12.5972,  ..., -12.5184, -12.2075, -12.3087],
         ...,
         [-12.3869, -10.8792, -11.0763,  ..., -13.6893,  -9.6316, -10.1180],
         [-12.8803, -11.2949, -11.1834,  ..., -14.0869,  -9.8902, -10.7025],
         [-12.1761, -10.6524, -10.8330,  ..., -13.5856,  -9.9655, -10.4757]]],
       device='cuda:0', grad_fn=<_DDPSinkBackward>)
pred shape:torch.Size([4, 300, 166])
########################### label ###########################
tensor([[ 4,  4,  5,  ...,  1,  1,  1],
        [ 4,  5,  4,  ...,  1,  1,  1],
        [ 7,  8, 10,  ...,  1,  1,  1],
        [16,  8, 10,  ...,  1,  1,  1]], device='cuda:0')
label shape:torch.Size([4, 300])
########################### valid_len ###########################
tensor([166, 156,  80,  65], device='cuda:0')
valid_len shape:torch.Size([4])
########################### weights ###########################
tensor([[1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0]], device='cuda:0')
########################### unweighted_loss ###########################
tensor([[1.5647e-03, 3.2103e-02, 5.1093e-02,  ..., 1.4103e+01, 1.4447e+01,
         1.3995e+01],
        [8.9818e-03, 9.3697e-03, 1.1620e-02,  ..., 1.0473e+01, 1.0066e+01,
         1.1333e+01],
        [8.9975e-03, 3.9102e-02, 3.1053e-03,  ..., 1.2913e+01, 1.2526e+01,
         1.2841e+01],
        [3.7351e-03, 5.1518e-03, 4.0084e-03,  ..., 1.0879e+01, 1.1295e+01,
         1.0652e+01]], device='cuda:0', grad_fn=<ViewBackward0>)
########################### weighted_loss ###########################
tensor([30.4404, 34.8478,  7.9073,  4.6482], device='cuda:0',
       grad_fn=<SumBackward1>)