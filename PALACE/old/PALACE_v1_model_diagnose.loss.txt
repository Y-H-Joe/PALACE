########################### pred ###########################
tensor([[[-14.4292, -14.6315, -15.0832,  ..., -14.7655, -14.8416, -14.8981],
         [-14.5118, -14.5335, -15.1135,  ..., -15.1176, -14.6036, -14.9553],
         [-14.8642, -14.6624, -15.2555,  ..., -15.3656, -14.5039, -15.1447],
         ...,
         [-15.0943, -15.1912, -15.4390,  ..., -15.2678, -15.0938, -14.7569],
         [-14.6693, -14.7229, -15.0991,  ..., -14.9910, -14.4185, -14.6626],
         [-14.1780, -14.0813, -14.8306,  ..., -14.4304, -13.8634, -14.6551]],

        [[-14.6703, -14.9617, -15.2872,  ..., -15.3203, -14.7587, -15.2746],
         [-14.7304, -14.7245, -15.4131,  ..., -15.1288, -14.8428, -15.1917],
         [-14.4849, -14.5237, -14.9944,  ..., -14.8642, -14.4181, -15.1583],
         ...,
         [-14.5171, -15.1821, -15.6108,  ..., -15.3660, -14.8437, -15.3132],
         [-14.1218, -14.1347, -14.6205,  ..., -14.5335, -14.1704, -14.5920],
         [-14.5014, -14.7077, -14.7736,  ..., -14.6045, -14.5094, -14.9809]],

        [[-14.2301, -15.0188, -15.1423,  ..., -14.8898, -14.3387, -15.1451],
         [-15.0928, -15.1982, -15.5969,  ..., -15.9942, -15.2051, -15.4453],
         [-14.7880, -15.0751, -15.2127,  ..., -15.2200, -14.9108, -15.1776],
         ...,
         [-14.9137, -15.1484, -15.3868,  ..., -15.3661, -14.9803, -15.2123],
         [-15.0272, -15.2184, -15.6855,  ..., -15.3515, -15.1586, -15.2433],
         [-14.8659, -14.6103, -15.5157,  ..., -15.2157, -14.9698, -15.0938]],

        [[-14.1956, -14.4839, -15.4444,  ..., -14.9854, -14.4299, -14.8286],
         [-14.7488, -14.5283, -15.3850,  ..., -15.5332, -14.7259, -15.0167],
         [-14.7434, -14.8151, -15.1707,  ..., -15.1557, -14.8092, -14.8544],
         ...,
         [-15.4154, -15.1476, -15.5950,  ..., -15.8061, -15.5328, -15.0660],
         [-15.0236, -14.9565, -15.7368,  ..., -15.7030, -15.1392, -14.5953],
         [-15.4387, -16.0031, -16.1170,  ..., -16.4478, -15.6734, -15.7626]]],
       device='cuda:0', grad_fn=<_DDPSinkBackward>)
pred shape:torch.Size([4, 300, 166])
########################### label ###########################
tensor([[ 4,  4,  5,  ...,  1,  1,  1],
        [ 4,  5,  4,  ...,  1,  1,  1],
        [ 7,  8, 10,  ...,  1,  1,  1],
        [16,  8, 10,  ...,  1,  1,  1]], device='cuda:0')
label shape:torch.Size([4, 300])
########################### valid_len ###########################
tensor([166, 156,  80,  65], device='cuda:0')
valid_len shape:torch.Size([4])
########################### weights ###########################
tensor([[1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0]], device='cuda:0')
########################### unweighted_loss ###########################
tensor([[ 1.6588,  1.8087,  1.9954,  ..., 15.1912, 14.7229, 14.0813],
        [ 1.7376,  2.0574,  1.8448,  ..., 15.1821, 14.1347, 14.7077],
        [ 2.1768,  2.7683,  3.3960,  ..., 15.1484, 15.2184, 14.6103],
        [ 3.7016,  2.7248,  3.3519,  ..., 15.1476, 14.9565, 16.0031]],
       device='cuda:0', grad_fn=<ViewBackward0>)
########################### weighted_loss ###########################
tensor([427.6423, 397.8701, 224.6668, 167.1161], device='cuda:0',
       grad_fn=<SumBackward1>)